# Automatic Drum Transcription with MAML and RNNs

## 概要
この研究は、**Meta-Learning（MAML: Model-Agnostic Meta-Learning）**を活用して、異なる環境や演奏スタイルに適応可能な**自動ドラム音転写モデル**を構築することを目的としています。音声信号からドラムの種類を分類し、適応性の高い機械学習モデルを開発することで、未知のドラム音源にも効果的に対応します。

---

## 研究の流れ
1. **データセット準備**
   - 音声データ（WAV形式）と対応するMIDIデータをペアで用意。
   - Grooveデータセットを利用して、音声ファイルとMIDIファイルを読み込み、データクリーニングを実施。
   - ドラム音（例: キック、スネア、ハイハット）を分類するため、特定のMIDIノートに対応付け。

2. **データ処理**
   - 音声信号から**MFCC（Mel-Frequency Cepstral Coefficients）**を抽出。
   - 各ドラムイベントの特徴量とラベルを生成し、データを学習用と検証用に分割。

3. **RNNモデル構築**
   - 時系列データの処理に適した**Recurrent Neural Network (RNN)** を構築。
   - モデルには以下の構造を採用：
     - **LSTM層**（128ユニット、2層）
     - **TimeDistributed Dense層**（64ユニット、最終的にドラムの種類に対応する8クラスのソフトマックス分類）

4. **MAMLの適用**
   - Meta-Learningを用いて、モデルをタスクに適応させるプロセスを導入。
     - **Task-Specific Adaptation:** 各タスクごとに、勾配を用いてモデルパラメータを更新。
     - **Meta-Training:** すべてのタスクから学習し、モデルの基盤となるパラメータを最適化。
   - 各タスクについて、学習データでパラメータを適応させ、検証データでメタ損失を計算。

5. **学習ループ**
   - 各エポックでタスクを順番に処理し、モデルをメタトレーニング。
   - 学習済みモデルを保存。

---

## 技術的なポイント
- **データ特徴量抽出:**
  音声信号から**MFCC**を抽出し、時間軸に沿ったドラムイベントごとの特徴を生成。
  
- **RNNの活用:**
  時系列データの処理に特化した**LSTM層**を使用して、各ドラムイベントの分類タスクを実行。

- **Meta-Learning:**
  - タスクごとの学習を通じてモデルを適応可能にする。
  - 新しいドラムパターンや音源に迅速に対応することを目指す。

---

## 実験結果
### モデル学習
- 学習は10エポックにわたって実施。
- 各タスクの入力データが適切であるか検証し、不足やエラーを除外。

### 損失計算と最適化
- 各タスクでのメタ損失を計算し、モデルの基盤パラメータを更新。

---

## 使用技術とライブラリ
- **Python ライブラリ:**
  - **TensorFlow/Keras:** モデル構築と学習
  - **Librosa:** 音声処理と特徴量抽出
  - **PrettyMIDI:** MIDIデータ処理
  - **TQDM:** プログレスバー表示
  - **Numpy/Pandas:** データ処理

---

## 保存されたモデル
最終的にトレーニングされたモデルは**`rnn_maml_drum_model.h5`**として保存され、今後の解析や推論に利用可能。

---

## 今後の課題
- より多様なドラム音源への適応性を検証。
- 推論速度の最適化。
- 未知のドラムイベントや複雑なパターンへの対応力の向上。

---

この研究は、**Meta-Learning**を活用して自動ドラム音転写の精度を向上させるとともに、実世界のデータに適応する能力を強化する革新的なアプローチを示しています。
